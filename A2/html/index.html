<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Assignment2: CSC360 Assignment 2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Assignment2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CSC360 Assignment 2 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Completed by:</p>
<h3>Bill Xiong - V00737042</h3>
<h3>Aahan Sureja - V00741138</h3>
<hr/>
<p><b>A brief note about the Quantum</b> Please run all tests on Quantum 10. We've found that in certain cases, running Rose.exe on Quantum 1 fails. Dr. Cheng has said that we don't need to fix this, as the size of the slice should not affect the correctness of the codes.</p>
<h2>Question 1 - The Readers/Writers Problem</h2>
<p>Our task was to implement the Readers/Writers problem with priority given to writers.</p>
<p>We divided the readers into two categories: activeReaders and waitingReaders. Since there is only one active writer at any given time, we used a boolean to signal whether there is an active writer or not.</p>
<p>For StartRead, we first check whether the database is already in the WRITING state. If it is, we add it to the readQ. Once its done waiting and there is 1 active reader, we change the state to READING.</p>
<p>For EndRead, we check if there are no more readers and there are one or more writers waiting to write. If so, we pass dbState directly to WRITING as opposed to NOTUSED, and signal the writeQ.</p>
<p>For StartWrite, we check for a reader or writer already reading or writing. In that case, we add it to the writeQ. Once its done waiting, it becomes active, and we turn the flag to true and the state of the database to WRITING.</p>
<p>In EndWrite we turn the activeWriter flag to false, change the database state to NOTUSED. If there are writers waiting, we signal the writeQ. Else, we broadcast the readQ.</p>
<h2>Question 2 - The Synchronous Readers-Writer Problem</h2>
<p>We implemented this similar to Question 1, with a few modifications to accommodate the synchronization.</p>
<p>In StartRead, we prevent a reader from reading ahead of the other readers by making it wait on a condition called waitingReaders. We count the number of readers coming in.</p>
<p>In Get, we increment the out position only when there are no more readers left.</p>
<p>In EndRead, the last reader broadcasts the waiting readers.</p>
<h2>Question 3 - POSIX Condition Variables</h2>
<p>For this part, we coded 3 methods. Please see the code under <code><a class="el" href="j__thread_8c_source.html">rose/j_thread.c</a></code> for more information.</p>
<p>For CondWait, we store the mutex that we release under the thread's relock field. This allows us to grab it in order to relock it when we get to the Signal method.</p>
<p>For CondSignal, we first check if thr_active has a relock field. If it does, we lock it and set the next thread in the condition's block queue to the mutex's block queue, so that the next time the active thread calls MutexUnlock, the mutex will pass to the next thread instead of getting unlocked.</p>
<p>For CondBroadcast, we do the same thing as CondSignal, except we DeQ everything from the condition block queue and EnQ it into the mutex's block queue</p>
<h2>Test Cases</h2>
<p>Part A</p>
<ul>
<li>To test the basic read/write case, run <code>a/TestBasicRW.bin</code> with Rose.</li>
<li>To test the priority, run <code>a/TestPreference.bin</code></li>
</ul>
<p>Part B</p>
<ul>
<li>To test 1 producer and 1 consumers, run <code>b/TestP1C1.bin</code></li>
<li>To test 1 producer and 3 consumers, run <code>b/TestP1C3.bin</code></li>
</ul>
<p>Part C</p>
<ul>
<li>Run <code>TestCases/UnitTest.bin</code> on quantum 10. The expected output is "[bb],[a[cc],a]," </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 19 2013 19:14:52 for Assignment2 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
