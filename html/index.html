<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Assignment1: CSC 360 Assignment 1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Assignment1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CSC 360 Assignment 1 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Completed by:</p>
<h3>Bill Xiong - V00737042</h3>
<h3>Aahan Suneja - V00741138</h3>
<hr/>
<h2>Our Solutions</h2>
<p>This is our first assignment. Please don't murder our marks.</p>
<h2>Question 1</h2>
<p>A) There are three threads racing to write to the same resource. The result <em>should</em> be 60,000; however, it isn't because one thread will always get to the resource before the other two. Like the poor Victorians counting flowers, the outcome of this program is completely nondeterminant.</p>
<p>B) When you set the main thread to DAEMON level before you start the three threads, the program halts with the correct value because the threads that are created are created at REAL_TIME, which is now a higher priority than the main thread. Thus, each thread preempts the main thread as it starts, runs until completion, then exits. In effect, this serializes the three threads and makes them run one at a time, thus giving the correct value.</p>
<p>When you set the main thread to DAEMON after the threads are already started, there is nothing to preempt. The three threads run in round robin fashion, and once again the result is nondeterminant.</p>
<p><em>What we did</em></p>
<p>An instantiator was added to <a class="el" href="_race_8java_source.html">Race.java</a>, we instantiated three instances of <a class="el" href="class_race.html" title="Solution for Question 1.">Race</a>, set them to run at Real-Time priority (1), started the three threads, then set the main thread to DAEMON priority (3).</p>
<p>You may uncomment line 26 and comment line 32 to see the program halt on the correct value.</p>
<h2>Question 2</h2>
<p>A) When we run the program with LockRace1 instead of <a class="el" href="class_lock_race.html" title="Solution to Question 2.">LockRace</a>, it results in a deadlock. <a class="el" href="class_lock_race.html" title="Solution to Question 2.">LockRace</a> is waiting for l2 and LockRace1 is waiting for l1. Each thread has acquired one lock, and each thread is spinning, waiting for the other lock to become free, resulting in no progress whatsoever.</p>
<p><em>What we did</em></p>
<p>We declared the necessary variables and spinlocks. When you use two <a class="el" href="class_lock_race.html" title="Solution to Question 2.">LockRace</a> instances, the program halts with correct values.</p>
<p>When you use both <a class="el" href="class_lock_race.html" title="Solution to Question 2.">LockRace</a> and LockRace1 instances, the program enters deadlock. To see this in action, please feel free to comment line 31 and uncomment 32.</p>
<h2>Question 3</h2>
<p><em>Test Cases</em> Feel free to look under /tests , which contains 3 test bin files that we used to test rose.</p>
<ul>
<li>1Thread.bin contains 1 thread of REAL_TIME priority.</li>
<li>2Threads.bin contains 2 threads of REAL_TIME priority.</li>
<li>2ThreadsDifferentPriority.bin contains 1 thread at REAL_TIME and 1 thread at USER priority levels.</li>
</ul>
<p>The same folder is also copied into /code/soln for you to test against.</p>
<p><em>What we did</em></p>
<p>Methods we completed in <a class="el" href="j__thread_8c_source.html">j_thread.c</a>: </p>
<h3>AddReady</h3>
<p>AddReady adds the thread you pass it into ready_q, according to priority. It does this via two things </p>
<h3>VMTick</h3>
<p>VMTick is called every time a tick is up. It decrements the active thread's ticks if the thread is at REAL_TIME or at User level. VMTick simply returns if the thread is at System or DAEMON level. </p>
<h3>Dispatch</h3>
<p>Dispatch pushes the next thread in ready_q into the running state. We also include some calls to keep track of the time that the thread started running and the cumulative time that the thread has been run. </p>
<h3>Reschedule</h3>
<p>Reschedule takes the current running thread, puts it back into ready mode, and calls AddReady to put it back into the ready queue. </p>
<h3>PreemptIfNecessary</h3>
<p>PreemptIfNecessary checks if there is a thread that is of higher priority at the beginning of the ready_q. If there is, we push the current thread out of the running state into the ready state, call AddReady to add that thread to the ready queue, and then call dispatch to get a new thread to run.</p>
<h2>Question 4</h2>
<p>A native method was added to <a class="el" href="_thread_8java_source.html">thread.java</a>, its stub was added to <a class="el" href="j__lang_8c_source.html">j_lang.c</a> and cputime() method was added to <a class="el" href="j__thread_8c_source.html">j_thread.c</a>.</p>
<p>Two additional int32's (startTime and deltaTime) were added to the struct thread_t in <a class="el" href="jvm_8h_source.html">jvm.h</a> to keep track of the start time of the thread and the deltaTime (the total elapsed time) of the thread.</p>
<p>Three additional methods were added to <a class="el" href="j__thread_8c_source.html">j_thread.c</a> in order to keep track of thread's times. We also Changed Rose so that it would call on these functions to determine the running time of the threads that we create.</p>
<p>Native methods are so difficult to get to work right. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed May 29 2013 18:16:14 for Assignment1 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
